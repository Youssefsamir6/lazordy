{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Lazordy Inventory{% endblock %}</title>

    {# Script to check and apply dark mode on load - MUST BE BEFORE CSS #}
    <script>
        // Check localStorage for a theme preference, or default to system preference
        if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>

    {# Your Tailwind CSS link #}
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    {# If you compile your own Tailwind CSS, uncomment this and adjust path: #}
    {# <link rel="stylesheet" href="{% static 'css/output.css' %}"> #}

    {% block extra_head %}{% endblock %}

</head>
{# Apply dark mode classes to the body for default text and background colors #}
<body class="bg-gray-100 font-sans antialiased text-gray-800 dark:bg-gray-900 dark:text-gray-100">

    <nav class="bg-blue-600 p-4 shadow-lg dark:bg-gray-800"> {# Added dark mode for navbar background #}
        <div class="container mx-auto flex justify-between items-center">
            <a href="{% url 'inventory:product_list' %}" class="flex items-center space-x-2">
                <img src="{% static 'inventory/images/primary_logo.png' %}" alt="Lazordy Logo" class="h-10">
                {# Uncomment the span below if you want text next to the logo #}
                {# <span class="text-white text-2xl font-bold tracking-tight hover:text-blue-100 transition-colors duration-200">Lazordy</span> #}
            </a>
            <div class="flex items-center space-x-4"> {# Changed to flex to align links and toggle button #}
                <a href="{% url 'inventory:product_list' %}" class="text-white hover:text-blue-100 font-medium px-3 py-2 rounded-md transition-colors duration-200">Products</a>
                <a href="{% url 'admin:index' %}" class="text-white hover:text-blue-100 font-medium px-3 py-2 rounded-md transition-colors duration-200">Admin</a>
                {# Add more links here later, e.g., for creating invoices #}

                {# --- DARK MODE TOGGLE BUTTON --- #}
                <button id="theme-toggle" onclick="toggleTheme()"
                        class="p-2 rounded-full text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 dark:hover:bg-gray-700">
                    <span id="theme-toggle-light-icon" class="inline-block">
                        ‚òÄÔ∏è
                    </span>
                    <span id="theme-toggle-dark-icon" class="inline-block">
                        üåô
                    </span>
                </button>
                {# --- END DARK MODE TOGGLE BUTTON --- #}
            </div>
        </div>
    </nav>

    <main class="container mx-auto p-6 mt-4">
        {% block content %}
            {# Content from child templates will go here #}
        {% endblock content %}
    </main>

    <footer class="bg-gray-800 text-white text-center p-4 mt-8 dark:bg-gray-950"> {# Added dark mode for footer background #}
        <div class="container mx-auto text-sm">
            &copy; {% now "Y" %} Lazordy Inventory. All rights reserved.
        </div>
    </footer>

    {# Script for the dark mode toggle function #}
    <script>
        function updateThemeToggleIcons() {
            const lightIcon = document.getElementById('theme-toggle-light-icon');
            const darkIcon = document.getElementById('theme-toggle-dark-icon');

            if (document.documentElement.classList.contains('dark')) {
                // If in dark mode, show sun icon (to switch to light)
                if (lightIcon) lightIcon.classList.remove('hidden');
                if (darkIcon) darkIcon.classList.add('hidden');
            } else {
                // If in light mode, show moon icon (to switch to dark)
                if (lightIcon) lightIcon.classList.add('hidden');
                if (darkIcon) darkIcon.classList.remove('hidden');
            }
        }

        function toggleTheme() {
            const html = document.documentElement;
            const isDark = html.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateThemeToggleIcons(); // Update icons immediately after toggling
        }

        // Call the function on page load to set the initial icon state
        document.addEventListener('DOMContentLoaded', updateThemeToggleIcons);
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>